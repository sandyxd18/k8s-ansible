---
- name: Prepare all nodes
  hosts: k8s_cluster
  gather_facts: true
  roles:
    - role: common
      tags:
        - common
    - role: container-runtime
      tags:
        - container-runtime
    - role: kubernetes
      tags:
        - kubernetes

- name: Setup Kubernetes Master
  hosts: master
  gather_facts: true
  roles:
    - role: master
      tags:
        - master
    - role: cni
      tags:
        - cni

- name: Join Worker Nodes
  hosts: workers
  gather_facts: true
  roles:
    - role: worker
      tags:
        - worker

- name: Deploy Addons
  hosts: master
  gather_facts: true
  roles:
    - role: addons
      tags:
        - addons
